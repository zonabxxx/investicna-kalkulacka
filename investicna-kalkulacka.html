<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulaƒçka investiƒçn√©ho bytu s infl√°ciou</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Calibri', Arial, sans-serif;
            background: #e8e8e8;
            padding: 20px;
        }
        
        .excel-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .excel-header {
            background: #217346;
            color: white;
            padding: 15px 20px;
            font-size: 18px;
            font-weight: bold;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            border: 1px solid #d0d0d0;
            padding: 8px 12px;
            text-align: left;
        }
        
        th {
            background: #f2f2f2;
            font-weight: 600;
            color: #333;
        }
        
        .section-header {
            background: #4472C4;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .label-cell {
            background: #F2F2F2;
            font-weight: 500;
        }
        
        .input-cell input {
            width: 100%;
            border: none;
            padding: 4px;
            font-size: 14px;
            background: white;
        }
        
        .input-cell input:focus {
            outline: 2px solid #217346;
        }
        
        .formula-cell {
            background: #FFF2CC;
            font-weight: 600;
            color: #000;
        }
        
        .result-cell {
            background: #C6E0B4;
            font-weight: bold;
            font-size: 15px;
        }
        
        .highlight-cell {
            background: #FFE699;
            font-weight: bold;
        }
        
        .number {
            text-align: right;
        }
        
        .currency::after {
            content: ' ‚Ç¨';
        }
        
        .percent::after {
            content: ' %';
        }
        
        .total-row {
            border-top: 2px solid #333;
            font-weight: bold;
        }
        
        .projection-table {
            margin-top: 30px;
            overflow-x: auto;
        }
        
        .projection-table table {
            font-size: 12px;
        }
        
        .projection-table th {
            background: #4472C4;
            color: white;
            position: sticky;
            top: 0;
        }
        
        .projection-table td {
            text-align: right;
        }
        
        .positive-cf {
            background: #C6E0B4 !important;
        }
        
        .negative-cf {
            background: #FFC7CE !important;
        }
        
        .info-box {
            padding: 20px;
            background: #E7F3FF;
            border-left: 4px solid #4472C4;
            margin: 20px;
        }
        
        @media print {
            body {
                background: white;
            }
        }
    </style>
</head>
<body>
    <div class="excel-container">
        <div class="excel-header">
            üìä INVESTIƒåN√ù BYT - ANAL√ùZA S INFL√ÅCIOU A DLHODOB√Å PROJEKCIA
        </div>
        
        <table>
            <!-- Z√ÅKLADN√â √öDAJE -->
            <tr class="section-header">
                <th colspan="2">A. Z√ÅKLADN√â √öDAJE O INVEST√çCII</th>
            </tr>
            <tr>
                <td class="label-cell">K√∫pna cena bytu</td>
                <td class="input-cell number"><input type="number" id="kupnaCena" value="150000" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr>
                <td class="label-cell">Vedƒæaj≈°ie n√°klady (not√°r, da≈à, prov√≠zie)</td>
                <td class="input-cell number"><input type="number" id="vedlajsieNaklady" value="5000" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr>
                <td class="label-cell">Rekon≈°trukcia/Zariadenie</td>
                <td class="input-cell number"><input type="number" id="rekonstrukcia" value="10000" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr class="total-row">
                <td class="label-cell">CELKOV√Å INVEST√çCIA</td>
                <td class="formula-cell number" id="celkovaInvesticia">165 000 ‚Ç¨</td>
            </tr>
            
            <!-- FINANCOVANIE -->
            <tr><td colspan="2" style="height: 10px; background: white;"></td></tr>
            <tr class="section-header">
                <th colspan="2">B. FINANCOVANIE</th>
            </tr>
            <tr>
                <td class="label-cell">Vlastn√© zdroje</td>
                <td class="input-cell number"><input type="number" id="vlastneZdroje" value="35000" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr>
                <td class="label-cell">Hypotek√°rny √∫ver</td>
                <td class="formula-cell number" id="vysukaUveru">130 000 ‚Ç¨</td>
            </tr>
            <tr>
                <td class="label-cell">√örokov√° sadzba p.a.</td>
                <td class="input-cell number"><input type="number" id="urok" value="3.8" step="0.1" oninput="calculate()"><span class="percent"></span></td>
            </tr>
            <tr>
                <td class="label-cell">Doba spl√°cania (roky)</td>
                <td class="input-cell number"><input type="number" id="dobaUveru" value="25" oninput="calculate()"></td>
            </tr>
            <tr class="highlight-cell">
                <td class="label-cell">Mesaƒçn√° spl√°tka √∫veru (fixn√°)</td>
                <td class="formula-cell number" id="mesacnaSplatka">692 ‚Ç¨</td>
            </tr>
            
            <!-- PR√çJMY -->
            <tr><td colspan="2" style="height: 10px; background: white;"></td></tr>
            <tr class="section-header">
                <th colspan="2">C. PR√çJMY Z PREN√ÅJMU</th>
            </tr>
            <tr>
                <td class="label-cell">Mesaƒçn√© n√°jomn√© (zaƒçiatoƒçn√©)</td>
                <td class="input-cell number"><input type="number" id="najomne" value="900" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr>
                <td class="label-cell">Obsadenos≈• (% mesiacov v roku)</td>
                <td class="input-cell number"><input type="number" id="obsadenost" value="92" oninput="calculate()"><span class="percent"></span></td>
            </tr>
            <tr>
                <td class="label-cell" style="color: #C65911; font-weight: bold;">‚ö° Roƒçn√° infl√°cia n√°jomn√©ho</td>
                <td class="input-cell number"><input type="number" id="inflaciaNajomne" value="3.5" step="0.1" oninput="calculate()"><span class="percent"></span></td>
            </tr>
            <tr class="formula-cell">
                <td class="label-cell">Roƒçn√© n√°jomn√© (1. rok)</td>
                <td class="number" id="rocneNajomne">9 936 ‚Ç¨</td>
            </tr>
            
            <!-- N√ÅKLADY -->
            <tr><td colspan="2" style="height: 10px; background: white;"></td></tr>
            <tr class="section-header">
                <th colspan="2">D. PREV√ÅDZKOV√â N√ÅKLADY</th>
            </tr>
            <tr>
                <td class="label-cell" style="padding-left: 20px;">Da≈à z nehnuteƒænosti (roƒçne)</td>
                <td class="input-cell number"><input type="number" id="dan" value="250" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr>
                <td class="label-cell" style="padding-left: 20px;">Poistenie nehnuteƒænosti (roƒçne)</td>
                <td class="input-cell number"><input type="number" id="poistenie" value="350" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr>
                <td class="label-cell" style="padding-left: 20px;">Spr√°va nehnuteƒænosti (mesaƒçne)</td>
                <td class="input-cell number"><input type="number" id="sprava" value="80" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr>
                <td class="label-cell" style="padding-left: 20px;">Fond opr√°v (mesaƒçne)</td>
                <td class="input-cell number"><input type="number" id="fondOprav" value="40" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr>
                <td class="label-cell" style="padding-left: 20px;">Rezerva na √∫dr≈æbu (mesaƒçne)</td>
                <td class="input-cell number"><input type="number" id="rezerva" value="60" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr>
                <td class="label-cell" style="padding-left: 20px;">Da≈à z pr√≠jmu (roƒçne)</td>
                <td class="input-cell number"><input type="number" id="danPrijem" value="800" oninput="calculate()"><span class="currency"></span></td>
            </tr>
            <tr>
                <td class="label-cell" style="color: #C65911; font-weight: bold;">‚ö° Roƒçn√° infl√°cia n√°kladov</td>
                <td class="input-cell number"><input type="number" id="inflaciaNakladov" value="2.5" step="0.1" oninput="calculate()"><span class="percent"></span></td>
            </tr>
            <tr class="total-row">
                <td class="label-cell">CELKOV√â ROƒåN√â N√ÅKLADY (1. rok)</td>
                <td class="formula-cell number" id="celkoveNaklady">3 610 ‚Ç¨</td>
            </tr>
            
            <!-- V√ùSLEDKY -->
            <tr><td colspan="2" style="height: 15px; background: white;"></td></tr>
            <tr class="section-header">
                <th colspan="2">E. CASH FLOW - PRV√ù ROK</th>
            </tr>
            <tr>
                <td class="label-cell">Roƒçn√© pr√≠jmy z n√°jmu</td>
                <td class="formula-cell number" id="prijmy">9 936 ‚Ç¨</td>
            </tr>
            <tr>
                <td class="label-cell">Roƒçn√© spl√°tky √∫veru</td>
                <td class="formula-cell number" id="splatkyRocne">8 304 ‚Ç¨</td>
            </tr>
            <tr>
                <td class="label-cell">Prev√°dzkov√© n√°klady</td>
                <td class="formula-cell number" id="nakladyRocne">3 610 ‚Ç¨</td>
            </tr>
            <tr class="result-cell">
                <td class="label-cell">ROƒåN√ù CASH FLOW (1. rok)</td>
                <td class="number" id="rocnyCashFlow">-1 978 ‚Ç¨</td>
            </tr>
            <tr class="result-cell">
                <td class="label-cell">MESAƒåN√ù CASH FLOW (1. rok)</td>
                <td class="number" id="mesacnyCashFlow">-165 ‚Ç¨</td>
            </tr>
            
            <!-- V√ùNOSNOS≈§ -->
            <tr><td colspan="2" style="height: 15px; background: white;"></td></tr>
            <tr class="section-header">
                <th colspan="2">F. UKAZOVATELE V√ùNOSNOSTI</th>
            </tr>
            <tr class="result-cell">
                <td class="label-cell">HRUB√ù V√ùNOS (1. rok)</td>
                <td class="number" id="hrubyVynos">6.02 %</td>
            </tr>
            <tr class="result-cell">
                <td class="label-cell">ƒåIST√ù V√ùNOS (1. rok)</td>
                <td class="number" id="cistyVynos">3.83 %</td>
            </tr>
            <tr class="result-cell">
                <td class="label-cell">ROI - Return on Investment (1. rok)</td>
                <td class="number" id="roi">-5.65 %</td>
            </tr>
            <tr class="result-cell">
                <td class="label-cell">CAP RATE (kapitalizaƒçn√° miera)</td>
                <td class="number" id="capRate">3.83 %</td>
            </tr>
            
            <!-- DLHODOB√â V√ùSLEDKY -->
            <tr><td colspan="2" style="height: 10px; background: white;"></td></tr>
            <tr class="result-cell">
                <td class="label-cell">‚≠ê CELKOV√Å SUMA DOPLATKOV (do kladn√©ho CF)</td>
                <td class="number" id="celkoveDoplatky" style="font-size: 16px;">0 ‚Ç¨</td>
            </tr>
            <tr class="result-cell">
                <td class="label-cell">‚≠ê SKUTOƒåN√Å INVEST√çCIA (s doplatkami)</td>
                <td class="number" id="skutocnaInvesticia" style="font-size: 16px;">35 000 ‚Ç¨</td>
            </tr>
            <tr class="result-cell">
                <td class="label-cell">‚≠ê ROK KLADN√âHO CASH FLOW</td>
                <td class="number" id="rokKladnehoCF" style="font-size: 16px;">3. rok</td>
            </tr>
            <tr class="result-cell">
                <td class="label-cell">‚≠ê N√ÅVRATNOS≈§ POƒåIATOƒåNEJ INVEST√çCIE</td>
                <td class="number" id="navratnostPociatocnej" style="font-size: 16px;">18.5 rokov</td>
            </tr>
            <tr class="result-cell">
                <td class="label-cell">‚≠ê N√ÅVRATNOS≈§ CELKOVEJ INVEST√çCIE (vr√°tane doplatkov)</td>
                <td class="number" id="dobaNavratnosti" style="font-size: 16px;">18.5 rokov</td>
            </tr>
        </table>
        
        <div class="info-box">
            <strong>üí° Ako to funguje - pe≈àa≈æn√Ω tok:</strong><br><br>
            
            <strong style="color: #217346;">1Ô∏è‚É£ N√ÅJOMCA PLAT√ç:</strong> Mesaƒçn√© n√°jomn√© ‚Üí ide v√°m<br>
            <strong style="color: #C65911;">2Ô∏è‚É£ Z N√ÅJOMN√âHO PLAT√çTE:</strong> Spl√°tku √∫veru + v≈°etky n√°klady (da≈à, poistenie, spr√°va...)<br>
            <strong style="color: #8B0000;">3Ô∏è‚É£ AK N√ÅJOMN√â NESTAƒå√ç:</strong> Dopl√°cate rozdiel zo svojho vrecka<br><br>
            
            <strong>üìä VA≈†A SKUTOƒåN√Å INVEST√çCIA:</strong><br>
            ‚Ä¢ Poƒçiatoƒçn√Ω vklad: <span id="displayVlastneZdroje" style="font-weight: bold;">35 000 ‚Ç¨</span><br>
            ‚Ä¢ Mesaƒçn√© doplatky (celkom): <span id="displayDoplatky" style="color: #8B0000; font-weight: bold;">0 ‚Ç¨</span><br>
            ‚Ä¢ <strong style="font-size: 1.1em;">= CELKOM: <span id="displaySkutocnaInv">35 000 ‚Ç¨</span></strong><br><br>
            
            <strong>üöÄ EFEKT INFL√ÅCIE:</strong><br>
            N√°jomn√© rastie o <span id="displayInflaciaNajomne">3.5%</span> roƒçne, spl√°tka zost√°va fixn√° <span id="displaySplatka">692 ‚Ç¨</span>/mes.<br>
            ‚Üí Ka≈æd√Ω rok dopl√°cate menej, potom zaƒçnete zar√°ba≈•!<br><br>
            
            <strong>‚úÖ N√°klady (da≈à, poistenie, spr√°va...) plat√≠te Z N√ÅJOMN√âHO, nie navy≈°e!</strong>
        </div>
        
        <!-- PROJEKCIA -->
        <div class="projection-table">
            <h3 style="padding: 20px; background: #4472C4; color: white; margin: 0;">
                üìà DLHODOB√Å PROJEKCIA (25 rokov)
            </h3>
            <table id="projectionTable">
                <thead>
                    <tr>
                        <th>Rok</th>
                        <th>N√°jomn√©<br>‚Ç¨/mes</th>
                        <th>Pr√≠jmy<br>‚Ç¨/rok</th>
                        <th>N√°klady<br>‚Ç¨/rok</th>
                        <th>Spl√°tky<br>‚Ç¨/rok</th>
                        <th>Cash Flow<br>‚Ç¨/rok</th>
                        <th>CF/mes</th>
                        <th>Kumulat√≠vny<br>CF ‚Ç¨</th>
                    </tr>
                </thead>
                <tbody id="projectionBody">
                </tbody>
            </table>
        </div>
        
        <div style="padding: 20px; background: #f9f9f9; border-top: 2px solid #ddd; margin-top: 20px;">
            <p style="font-size: 12px; color: #666; line-height: 1.6;">
                <strong>Vysvetlivky:</strong><br>
                ‚Ä¢ <strong>Poƒçiatoƒçn√° invest√≠cia</strong>: Va≈°e vlastn√© zdroje na zaƒçiatku (napr. 5 000 ‚Ç¨ alebo 35 000 ‚Ç¨)<br>
                ‚Ä¢ <strong>Mesaƒçn√Ω cash flow</strong>: N√°jomn√© M√çNUS spl√°tka M√çNUS n√°klady = ƒço v√°m zostane (alebo mus√≠te doplati≈•)<br>
                ‚Ä¢ <strong>Celkov√° suma doplatkov</strong>: S√∫ƒçet v≈°etk√Ωch mesaƒçn√Ωch doplatkov v z√°porn√Ωch rokoch<br>
                ‚Ä¢ <strong>Skutoƒçn√° invest√≠cia</strong>: Poƒçiatoƒçn√Ω vklad + v≈°etky doplatky = celkom ƒço ste dali zo svojho<br>
                ‚Ä¢ <strong>Rok kladn√©ho CF</strong>: Kedy prestanete dopl√°ca≈• a n√°jomn√© u≈æ pokryje v≈°etko + v√°m nieƒço zostane<br>
                ‚Ä¢ <strong>Kumulat√≠vny CF</strong>: Celkov√Ω zisk/strata od zaƒçiatku (nezah≈ï≈àa poƒçiatoƒçn√Ω vklad, len mesaƒçn√© toky)<br><br>
                <strong>üí° Pr√≠klad (1. rok):</strong> N√°jomn√© 900 ‚Ç¨ - Spl√°tka 692 ‚Ç¨ - N√°klady 301 ‚Ç¨ = <strong>-93 ‚Ç¨ mus√≠te doplati≈•</strong><br>
                Toto je v√°≈° skutoƒçn√Ω mesaƒçn√Ω v√Ωdaj, nie celkov√Ωch 993 ‚Ç¨!
            </p>
        </div>
    </div>
    
    <script>
        function calculate() {
            // Vstupn√© hodnoty
            const kupnaCena = parseFloat(document.getElementById('kupnaCena').value) || 0;
            const vedlajsieNaklady = parseFloat(document.getElementById('vedlajsieNaklady').value) || 0;
            const rekonstrukcia = parseFloat(document.getElementById('rekonstrukcia').value) || 0;
            const vlastneZdroje = parseFloat(document.getElementById('vlastneZdroje').value) || 0;
            const urok = parseFloat(document.getElementById('urok').value) || 0;
            const dobaUveru = parseFloat(document.getElementById('dobaUveru').value) || 0;
            const najomne = parseFloat(document.getElementById('najomne').value) || 0;
            const obsadenost = parseFloat(document.getElementById('obsadenost').value) || 0;
            const dan = parseFloat(document.getElementById('dan').value) || 0;
            const poistenie = parseFloat(document.getElementById('poistenie').value) || 0;
            const sprava = parseFloat(document.getElementById('sprava').value) || 0;
            const fondOprav = parseFloat(document.getElementById('fondOprav').value) || 0;
            const rezerva = parseFloat(document.getElementById('rezerva').value) || 0;
            const danPrijem = parseFloat(document.getElementById('danPrijem').value) || 0;
            const inflaciaNajomne = parseFloat(document.getElementById('inflaciaNajomne').value) || 0;
            const inflaciaNakladov = parseFloat(document.getElementById('inflaciaNakladov').value) || 0;
            
            // Celkov√° invest√≠cia
            const celkovaInvesticia = kupnaCena + vedlajsieNaklady + rekonstrukcia;
            document.getElementById('celkovaInvesticia').textContent = celkovaInvesticia.toLocaleString('sk-SK') + ' ‚Ç¨';
            
            // V√Ω≈°ka √∫veru
            const vysukaUveru = celkovaInvesticia - vlastneZdroje;
            document.getElementById('vysukaUveru').textContent = vysukaUveru.toLocaleString('sk-SK') + ' ‚Ç¨';
            
            // Mesaƒçn√° spl√°tka √∫veru
            const mesiacneUroky = urok / 100 / 12;
            const pocetSplatok = dobaUveru * 12;
            let mesacnaSplatka = 0;
            
            if (vysukaUveru > 0 && mesiacneUroky > 0) {
                mesacnaSplatka = vysukaUveru * (mesiacneUroky * Math.pow(1 + mesiacneUroky, pocetSplatok)) / 
                                 (Math.pow(1 + mesiacneUroky, pocetSplatok) - 1);
            }
            document.getElementById('mesacnaSplatka').textContent = mesacnaSplatka.toFixed(0) + ' ‚Ç¨';
            document.getElementById('displaySplatka').textContent = mesacnaSplatka.toFixed(0) + ' ‚Ç¨';
            document.getElementById('displayInflaciaNajomne').textContent = inflaciaNajomne + '%';
            document.getElementById('displayVlastneZdroje').textContent = vlastneZdroje.toLocaleString('sk-SK') + ' ‚Ç¨';
            
            // Prv√Ω rok
            const rocneNajomne = najomne * 12 * (obsadenost / 100);
            document.getElementById('rocneNajomne').textContent = rocneNajomne.toFixed(0) + ' ‚Ç¨';
            
            const celkoveNaklady = dan + poistenie + (sprava * 12) + (fondOprav * 12) + (rezerva * 12) + danPrijem;
            document.getElementById('celkoveNaklady').textContent = celkoveNaklady.toFixed(0) + ' ‚Ç¨';
            
            const rocneSplatky = mesacnaSplatka * 12;
            const rocnyCashFlow = rocneNajomne - rocneSplatky - celkoveNaklady;
            const mesacnyCashFlow = rocnyCashFlow / 12;
            
            document.getElementById('prijmy').textContent = rocneNajomne.toFixed(0) + ' ‚Ç¨';
            document.getElementById('splatkyRocne').textContent = rocneSplatky.toFixed(0) + ' ‚Ç¨';
            document.getElementById('nakladyRocne').textContent = celkoveNaklady.toFixed(0) + ' ‚Ç¨';
            
            const cashFlowElement = document.getElementById('rocnyCashFlow');
            cashFlowElement.textContent = rocnyCashFlow.toFixed(0) + ' ‚Ç¨';
            cashFlowElement.style.color = rocnyCashFlow >= 0 ? '#006400' : '#8B0000';
            
            const mesacnyElement = document.getElementById('mesacnyCashFlow');
            mesacnyElement.textContent = mesacnyCashFlow.toFixed(0) + ' ‚Ç¨';
            mesacnyElement.style.color = mesacnyCashFlow >= 0 ? '#006400' : '#8B0000';
            
            // V√Ωnosnos≈•
            const hrubyVynos = (najomne * 12 / kupnaCena) * 100;
            const cistyVynos = ((rocneNajomne - celkoveNaklady) / celkovaInvesticia) * 100;
            const roi = vlastneZdroje > 0 ? (rocnyCashFlow / vlastneZdroje) * 100 : 0;
            const capRate = ((rocneNajomne - celkoveNaklady) / celkovaInvesticia) * 100;
            
            document.getElementById('hrubyVynos').textContent = hrubyVynos.toFixed(2) + ' %';
            document.getElementById('cistyVynos').textContent = cistyVynos.toFixed(2) + ' %';
            
            const roiElement = document.getElementById('roi');
            roiElement.textContent = roi.toFixed(2) + ' %';
            roiElement.style.color = roi >= 0 ? '#006400' : '#8B0000';
            
            document.getElementById('capRate').textContent = capRate.toFixed(2) + ' %';
            
            // Projekcia na 25 rokov
            const projectionBody = document.getElementById('projectionBody');
            projectionBody.innerHTML = '';
            
            let aktualneNajomne = najomne;
            let aktualneNaklady = celkoveNaklady;
            let kumulativnyCF = 0;
            let rokKladnehoCF = 0;
            let navratnostPociatocnej = 0;
            let navratnostCelkovej = 0;
            let celkoveDoplatky = 0;
            let maximalnyZapornyKumulativnyCF = 0;
            
            for (let rok = 1; rok <= 25; rok++) {
                const rocnePrijmy = aktualneNajomne * 12 * (obsadenost / 100);
                const rocnyCF = rocnePrijmy - rocneSplatky - aktualneNaklady;
                const mesacnyCF = rocnyCF / 12;
                kumulativnyCF += rocnyCF;
                
                // Sledovanie najv√§ƒç≈°ej kumulat√≠vnej straty
                if (kumulativnyCF < maximalnyZapornyKumulativnyCF) {
                    maximalnyZapornyKumulativnyCF = kumulativnyCF;
                }
                
                // Prv√Ω rok s kladn√Ωm CF
                if (rokKladnehoCF === 0 && rocnyCF > 0) {
                    rokKladnehoCF = rok;
                    celkoveDoplatky = Math.abs(maximalnyZapornyKumulativnyCF);
                }
                
                // N√°vratnos≈• poƒçiatoƒçnej invest√≠cie (len vlastn√© zdroje)
                if (navratnostPociatocnej === 0 && kumulativnyCF >= 0) {
                    navratnostPociatocnej = rok;
                }
                
                // N√°vratnos≈• celkovej invest√≠cie (vlastn√© zdroje + v≈°etky doplatky)
                const celkovaInvesticiaSDoplatkami = vlastneZdroje + Math.abs(maximalnyZapornyKumulativnyCF);
                if (navratnostCelkovej === 0 && kumulativnyCF >= celkovaInvesticiaSDoplatkami - vlastneZdroje) {
                    navratnostCelkovej = rok;
                }
                
                const row = projectionBody.insertRow();
                const cfClass = rocnyCF >= 0 ? 'positive-cf' : 'negative-cf';
                
                row.innerHTML = `
                    <td style="font-weight: bold;">${rok}</td>
                    <td>${aktualneNajomne.toFixed(0)} ‚Ç¨</td>
                    <td>${rocnePrijmy.toFixed(0)} ‚Ç¨</td>
                    <td>${aktualneNaklady.toFixed(0)} ‚Ç¨</td>
                    <td>${rocneSplatky.toFixed(0)} ‚Ç¨</td>
                    <td class="${cfClass}" style="font-weight: bold;">${rocnyCF.toFixed(0)} ‚Ç¨</td>
                    <td class="${cfClass}">${mesacnyCF.toFixed(0)} ‚Ç¨</td>
                    <td style="font-weight: bold;">${kumulativnyCF.toFixed(0)} ‚Ç¨</td>
                `;
                
                // Infl√°cia pre ƒèal≈°√≠ rok
                aktualneNajomne = aktualneNajomne * (1 + inflaciaNajomne / 100);
                aktualneNaklady = aktualneNaklady * (1 + inflaciaNakladov / 100);
            }
            
            // Skutoƒçn√° celkov√° invest√≠cia
            const skutocnaInvesticia = vlastneZdroje + celkoveDoplatky;
            
            // Zobrazenie v√Ωsledkov
            document.getElementById('celkoveDoplatky').textContent = celkoveDoplatky.toFixed(0) + ' ‚Ç¨';
            document.getElementById('celkoveDoplatky').style.color = celkoveDoplatky > 0 ? '#8B0000' : '#006400';
            
            document.getElementById('skutocnaInvesticia').textContent = skutocnaInvesticia.toFixed(0) + ' ‚Ç¨';
            
            // Aktualiz√°cia info boxu
            document.getElementById('displayDoplatky').textContent = celkoveDoplatky.toFixed(0) + ' ‚Ç¨';
            document.getElementById('displaySkutocnaInv').textContent = skutocnaInvesticia.toLocaleString('sk-SK') + ' ‚Ç¨';
            
            const rokCFElement = document.getElementById('rokKladnehoCF');
            if (rokKladnehoCF > 0) {
                rokCFElement.textContent = rokKladnehoCF + '. rok';
                rokCFElement.style.color = '#006400';
            } else {
                rokCFElement.textContent = 'Nikdy (25+ rokov)';
                rokCFElement.style.color = '#8B0000';
            }
            
            const navratnostPocElement = document.getElementById('navratnostPociatocnej');
            if (navratnostPociatocnej > 0) {
                navratnostPocElement.textContent = navratnostPociatocnej + ' rokov';
                navratnostPocElement.style.color = '#006400';
            } else {
                navratnostPocElement.textContent = '25+ rokov';
                navratnostPocElement.style.color = '#FF6600';
            }
            
            const dobaElement = document.getElementById('dobaNavratnosti');
            if (navratnostCelkovej > 0) {
                dobaElement.textContent = navratnostCelkovej + ' rokov';
                dobaElement.style.color = '#006400';
            } else {
                dobaElement.textContent = '25+ rokov';
                dobaElement.style.color = '#FF6600';
            }
        }
        
        // Prvotn√Ω v√Ωpoƒçet
        calculate();
    </script>
</body>
</html>

